<!DOCTYPE html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>MUSUBI - ì¼ìƒ ê³µìœ </title>
    <link rel="stylesheet" th:href="@{/css/feedWrite.css}">
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR:wght@400;500;700&display=swap" rel="stylesheet">
</head>
<body>

<header th:fragment="header" xmlns:th="http://www.thymeleaf.org"
        xmlns:sec="http://www.thymeleaf.org/extras/spring-security" class="header">

    <div class="header-inner">

        <!-- ë¡œê³  -->
        <div class="logo" th:onclick="|location.href='@{/}'|">
            ğŸ’¬ MUSUBI
        </div>

        <!-- ë„¤ë¹„ê²Œì´ì…˜ -->
        <nav class="nav">
            <a th:href="@{/community}">ì»¤ë®¤ë‹ˆí‹°</a>
            <a th:href="@{/recommend}">íŒŒíŠ¸ë„ˆì°¾ê¸°</a>
            <a th:href="@{/chat}">ì±„íŒ…</a>
            <a th:href="@{/support}">ê³ ê°ì„¼í„°</a>
        </nav>

        <!-- ì¸ì¦ ë²„íŠ¼ ì˜ì—­ -->
        <div class="auth-buttons">

            <!-- =========================
                 ë¹„ë¡œê·¸ì¸ ìƒíƒœ
            ========================= -->
            <div sec:authorize="isAnonymous()">
                <button class="login-btn" type="button" th:onclick="|location.href='@{/login}'|">
                    ë¡œê·¸ì¸
                </button>

                <button class="signup-btn" type="button" th:onclick="|location.href='@{/member/signup}'|">
                    íšŒì›ê°€ì…
                </button>
            </div>

            <!-- =========================
                 ë¡œê·¸ì¸ ìƒíƒœ
            ========================= -->
            <div sec:authorize="isAuthenticated()">
                <button class="login-btn" type="button" onclick="logout()">
                    ë¡œê·¸ì•„ì›ƒ
                </button>
            </div>

        </div>
    </div>

    <!-- ë¡œê·¸ì•„ì›ƒ JS (ê³µí†µ) -->
    <script th:src="@{/js/member/logout.js}"></script>

</header>

<main class="feed-container">
    <form th:action="@{/board/feedWrite}" method="post" enctype="multipart/form-data" class="feed-card">

        <div class="card-header">
            <div class="user-profile">
                <img th:src="${user?.profileImagePath ?: '/images/profile/default.png'}"
                     alt="User" class="profile-img">
                <div class="user-info">
                    <span class="username" th:text="${user.nickname}"></span>
                    <span class="location" th:text="${user.nation}"></span>
                </div>
            </div>
            <button type="button" class="close-btn" onclick="history.back()">âœ•</button>
        </div>

        <div class="image-preview-area" id="previewArea">
            <div class="placeholder-text">
                <span>ğŸ“·</span>
                <p>ì‚¬ì§„ì„ ëŒì–´ì˜¤ê±°ë‚˜ í´ë¦­í•´ì„œ ì—…ë¡œë“œí•˜ì„¸ìš”</p>
            </div>
            <img id="imagePreview" src="" alt="Preview" style="display:none;">
            <input type="file" name="upload" id="fileInput" accept="image/*" required>
        </div>

        <div class="content-area">
            <textarea name="content" placeholder="ë¬¸ë“ ë“  ìƒê°ì´ë‚˜ ì¼ìƒì„ ê³µìœ í•´ë³´ì„¸ìš”..." required></textarea>
            <input type="hidden" name="title" value="ì¼ìƒ í”¼ë“œì…ë‹ˆë‹¤.">
        </div>

        <div class="card-footer">
            <button type="submit" class="share-btn">ê³µìœ í•˜ê¸°</button>
        </div>

    </form>
</main>

<footer th:fragment="footer" class="site-footer">
    <div class="footer-inner">

        <div class="footer-links">
            <div class="footer-col">
                <h4>ì†Œê°œ</h4>
                <a href="#">ì„œë¹„ìŠ¤ ì†Œê°œ</a>
            </div>

            <div class="footer-col">
                <h4>ì œí’ˆ</h4>
                <a href="#">ì»¤ë®¤ë‹ˆí‹°</a>
                <a href="#">íŒŒíŠ¸ë„ˆ ì°¾ê¸°</a>
                <a href="#">ì±„íŒ…</a>
            </div>

            <div class="footer-col">
                <h4>ê°€ì´ë“œ</h4>
                <a href="#">ì´ìš© ì•ˆë‚´</a>
                <a href="#">ìì£¼ í•˜ëŠ” ì§ˆë¬¸</a>
                <a href="#">ì´ìš© ê°€ì´ë“œ</a>
            </div>

            <div class="footer-col">
                <h4>ì§€ì›</h4>
                <a href="#">ê³µì§€ì‚¬í•­</a>
                <a href="#">1:1 ë¬¸ì˜</a>
                <a href="#">ê³ ê°ì„¼í„°</a>
            </div>
        </div>

        <div class="footer-bottom">
            <div class="footer-meta">
                <span>ì´ìš©ì•½ê´€</span>
                <span>Â·</span>
                <span>ê°œì¸ì •ë³´ ì²˜ë¦¬ë°©ì¹¨</span>
                <span>Â·</span>
                <span>ê³ ê°ì„¼í„°</span>
            </div>

            <div class="footer-copy">
                Â© 2026 MUSUBI. All rights reserved.
            </div>
        </div>

    </div>
</footer>

<script>
    const fileInput = document.getElementById('fileInput');
    const previewArea = document.getElementById('previewArea');
    const imagePreview = document.getElementById('imagePreview');
    const placeholder = document.querySelector('.placeholder-text');

    // ì˜ì—­ í´ë¦­ ì‹œ íŒŒì¼ì°½ ì—´ê¸°
    previewArea.addEventListener('click', () => fileInput.click());

    // íŒŒì¼ ì„ íƒ ì‹œ ë¯¸ë¦¬ë³´ê¸° ë³€ê²½
    fileInput.addEventListener('change', function(e) {
        const file = e.target.files[0];
        if (file) {
            const reader = new FileReader();
            reader.onload = function(e) {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                placeholder.style.display = 'none';
            }
            reader.readAsDataURL(file);
        }
    });
</script>
</body>
</html>