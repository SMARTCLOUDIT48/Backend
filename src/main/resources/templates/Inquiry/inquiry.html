<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>1:1 문의 | Musubi</title>
    <link rel="stylesheet" th:href="@{/css/layout.css}">
    <link rel="stylesheet" th:href="@{/css/inquiry/inquiry.css}">
</head>
<body>

<div th:replace="~{fragments/header :: header}"></div>

<main class="inquiry-wrapper">

    <!-- ======================
         좌측 문의 작성
    ====================== -->
    <section class="inquiry-form">
        <h3>1:1 문의하기</h3>

        <form method="post" enctype="multipart/form-data">

            <!-- 문의 유형 -->
            <div class="field">
                <label>문의 유형</label>
                <select name="type" required>
                    <option value="">문의 유형 선택</option>
                    <option value="ACCOUNT">계정</option>
                    <option value="CHAT">채팅</option>
                    <option value="REPORT">신고</option>
                    <option value="ETC">기타</option>
                </select>
            </div>

            <!-- 제목 -->
            <div class="field">
                <label>제목</label>
                <input type="text" name="title" placeholder="문의 제목" required>
            </div>

            <!-- 내용 -->
            <div class="field">
                <label>내용</label>
                <textarea name="content" placeholder="문의 내용을 입력하세요" required></textarea>
            </div>

            <!-- ======================
                 📎 파일 첨부 영역
            ====================== -->
            <div class="file-field">
                <!-- 실제 파일 input -->
                <input type="file"
                       id="fileInput"
                       name="image"
                       accept="image/*"
                       hidden>

                <!-- 가짜 버튼 -->
                <label for="fileInput" class="file-btn">
                    사진 첨부
                </label>

                <!-- 파일명 -->
                <span class="file-name" id="fileName">
                    선택된 파일 없음
                </span>
            </div>

            <!-- 미리보기 -->
            <div class="preview hidden" id="preview">
                <img id="previewImg" alt="미리보기 이미지">
                <span id="previewName"></span>
                <button type="button" class="remove-btn" id="removeFile">✕</button>
            </div>

            <!-- 등록 버튼 -->
            <button type="submit" class="submit-btn">
                문의 등록
            </button>

        </form>
    </section>

    <!-- ======================
         우측 문의 내역
    ====================== -->
    <section class="inquiry-list">
        <h3>내 문의 내역</h3>

        <ul class="inquiry-ul">

            <li th:each="inq : ${inquiries}"
                class="inquiry-item"
                tabindex="0"
                th:attr="
                    data-status=${inq.status.name()},
                    data-title=${inq.title},
                    data-content=${inq.content},
                    data-answer=${inq.answerContent}
                ">

                <div class="item-left">
                    <div class="title" th:text="${inq.title}"></div>

                    <span class="status"
                          th:text="${inq.status.name() == 'WAITING' ? '대기중' : '답변완료'}"
                          th:classappend="${inq.status.name().toLowerCase()}">
                    </span>
                </div>

                <!-- 수정 → 상세 페이지 이동 -->
                <a th:href="@{/customer/inquiry/{id}(id=${inq.inquiryId})}"
                   class="edit-btn">
                    수정
                </a>

            </li>
        </ul>
    </section>

</main>

<!-- ======================
     문의 / 답변 모달
====================== -->
<div id="viewModal" class="modal-overlay hidden">
    <div class="modal-card">
        <h3 id="modalTitle"></h3>

        <div class="inquiry-preview">
            <div class="inquiry-label">문의 내용</div>
            <div id="modalInquiryContent" class="inquiry-content"></div>
        </div>

        <div class="inquiry-preview">
            <div class="inquiry-label">답변</div>
            <div id="modalAnswerContent" class="inquiry-content"></div>
        </div>

        <div class="modal-actions">
            <button type="button" class="btn-cancel" id="modalCloseBtn">
                닫기
            </button>
        </div>
    </div>
</div>

<div th:replace="~{fragments/footer :: footer}"></div>

<script th:src="@{/js/inquiry/inquiry.js}"></script>
</body>
</html>
