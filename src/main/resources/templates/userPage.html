<!doctype html>
<html lang="ko" xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Musubi - 사용자 페이지</title>

    <link rel="stylesheet" th:href="@{/css/userPage.css}" />
    <link rel="stylesheet" th:href="@{/css/layout.css}">

    <script th:inline="javascript">
        /*<![CDATA[*/
        const CONTEXT_PATH = /*[[@{/}]]*/ "/";
        /*]]>*/
    </script>
    <script type="module" th:src="@{/js/member/userPage.js}"></script>
</head>

<body>

<div th:replace="~{fragments/header :: header}"></div>

<main class="page">
    <section class="shell">

        <section class="grid">

            <aside class="sidebar">

                <div class="glass card profile-card">

                    <div class="avatar-wrap">
                        <img id="profileImage" class="avatar"
                             th:src="${user.profileImageName != null ? '/images/profile/upload/' + user.profileImageName : '/images/profile/default.png'}"
                             alt="profile" />
                    </div>

                    <div class="profile-meta">
                        <h3 class="nickname">
                            <span id="nickname" th:text="${user.nickname}">닉네임</span>
                            <span id="age" class="age" th:if="${user.age != null}" th:text="'(' + ${user.age} + ')'">(24)</span>
                            <span id="nationFlag" th:text="${user.nation}">🇰🇷</span>
                        </h3>

                        <div class="likeAndProfileContainer">
                            <div class="like-dislike">
                                <button id="likeBtn" class="likeBtn">
                                    👍 <span id="likeCount1">0</span>
                                </button>
                                <button id="dislikeBtn" class="likeBtn">
                                    👎
                                </button>
                            </div>
                        </div>

                        <div class="profile-lang-block">
                            <div class="lang-line">
                                <span id="nativeLang" class="lang-flag">🇰🇷</span>
                                <span class="arrow">→</span>
                                <span id="studyLang" class="lang-flag">🇯🇵</span>
                                <span id="levelLanguage" class="level-text">Intermediate</span>
                            </div>

                            <div class="manner-line" data-value="36.5">
                                <div class="manner-fill"></div>
                                <span id="manner" class="manner"></span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="glass card profile-card">
                    <div class="profile-intro">
                        <p id="intro" th:text="${user.intro}">자기소개가 없습니다.</p>
                    </div>
                </div>

                <nav class="glass card menu">
                    <a class="menu-item active" th:href="@{/member/userPage/{id}/userBoardList(id=${user.memberId})}">
                        <span class="mi-ico">📘</span>
                        <span th:text="|${user.nickname}님의 게시글|">닉네임님의 게시글</span>
                        <span class="badge">3</span>
                    </a>
                </nav>

                <div class="glass card mini-card">
                    <div class="mini-head">
                        <h4>친한 목록</h4>
                        <span class="mini-pill">Active</span>
                    </div>
                    <div class="mini-row">
                        <div class="mini-avatar"></div>
                        <div class="mini-text">
                            <div class="mini-name">스라</div>
                            <div class="mini-sub">여행 · 영화</div>
                        </div>
                    </div>
                </div>

                <div class="glass card mini-card">
                    <div class="mini-head">
                        <h4>관심사</h4>
                    </div>
                    <div class="chip-wrap" id="interestChips">
                    </div>
                </div>

            </aside>


            <section class="content">

                <div class="glass card content-card">
                    <div class="card-head">
                        <div>
                            <h2 th:text="|${user.nickname}님과 관심사가 비슷한 친구|">관심사에 맞는 친구 추천</h2>
                            <p th:text="|${user.nickname}님의 관심사를 바탕으로 추천해드려요.|">내 관심사에 맞는 친구를 추천해드려요.</p>
                        </div>
                        <button type="button" class="btn btn-member" onclick="location.href='/recommend'">
                            더보기
                        </button>
                    </div>
                    <div class="reco-grid" id="recommendGrid"></div>
                </div>

                <div class="glass card content-card stat-card">
                    <div class="stat-head">
                        <h3 th:text="|${user.nickname}님의 게시글 통계|">게시글 통계</h3>
                        <span class="muted">누적</span>
                    </div>

                    <div class="stat-body">
                        <div class="stat-item posts">
                            <span class="stat-label">📝 게시글</span>
                            <span class="stat-value" id="postCount">0</span>
                        </div>

                        <div class="stat-item likes">
                            <span class="stat-label">❤️ 좋아요</span>
                            <span class="stat-value" id="likeCount2">0</span>
                        </div>

                        <div class="stat-item comments">
                            <span class="stat-label">💬 댓글</span>
                            <span class="stat-value" id="commentCount">0</span>
                        </div>
                    </div>

                    <div class="extra-container">
                        <div class="stat-extra">
                            <span class="extra-label">💌 현재 연락 중인 이성</span>
                            <strong class="extra-value" id="chattingCount">0</strong>
                            <span class="extra-unit">명</span>
                        </div>
                    </div>
                </div>

            </section>
        </section>
    </section>
</main>

<div th:replace="~{fragments/footer :: footer}"></div>

</body>
</html>